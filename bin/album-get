#!/bin/bash

if [[ $1 =~ \. ]]; then
  [[ -n "$2" ]] && base="$2" || base=$( echo $1 | sed -n 's/\..*$//p' )
  base_url=$1
else
  base=$1
  base_url=$base.bandcamp.com
fi
shift

echo ">> Using $base"
[ -e $base ] || mkdir $base
cd $base

for i in $(curl -s https://$base_url/ | grep -Po '(?<=album\/)[^?"]*' ); do
  (
    [ -e $i ] || mkdir $i
    cd $i
    url=https://$base_url/album/$i
    echo -e "\n\n$url\n\n"
    youtube-dl $url
  )
done
