#!/bin/sh

prog=$( basename $0 )
internal=$( xrandr | grep primary | awk ' { print $1 }' )
external=$( xrandr | grep -v primary | grep \ connected | awk ' { print $1 }' )

[ -z "$external" ] && echo "Can't find external monitor with xrandr. Exiting" && exit 1
[ -z "$internal" ] && echo "Can't find internal monitor with xrandr. Exiting" && exit 1

orient=${1:-portrait}
dual=$2

portrait() {
  echo xrandr --output $external --auto --mode 1600x1200 --rotate left --output $internal $opts
}
landscape() {
  echo xrandr --output $external --auto --mode 1600x1200 --output $internal $opts
}

if [ $dual ]; then
  opts="--auto --left-of $external"
else
  opts="--off"
fi

eval $orient
if [ $? ] ; then
  setxkbmap -option ctrl:nocaps  
  xmodmap ~/.Xmodmap
  xrdb -merge ~/.Xresources

  xrandr --dpi 75

  sleep 1
  pkill notion
  sleep 1
  notion&
else
  echo "Failed"
fi
